---
description: Core architectural decisions and implementation rules for the journal application
globs: 
alwaysApply: true
---
# Project Context
This project is a personal journaling application that helps users document and share their life stories, reflections, photos, and media with others.

## Scope
  - Story and reflection creation and management
  - Photo and media integration
  - Tag-based organization
  - Family sharing and interaction
  - AI-assisted content creation and organization

## Technical Stack
  - Frontend: 
    - Next.js 15.3.2
    - React 19
    - TypeScript
    - Native CSS
    - TipTap for rich text editing
    - Framer Motion for animations
  - Backend: 
    - Firebase (Firestore, Authentication, Storage)
    - Firebase Admin SDK for server-side operations
  - AI: OpenAI integration for content assistance
  - Media: Google Photos API (primary), with future support for Apple Photos
  - Hosting: Netlify (primary), with Vercel as backup
  - Version Control: GitHub
  - Testing: Jest, React Testing Library
  - Development Tools:
    - ESLint for code quality
    - TypeScript for type safety
    - Jest for testing
    - Custom scripts for migration and backup

## Deployment Model
  - Netlify for hosting and CI/CD
  - GitHub for source control and collaboration
  - Firebase for backend services
 

## Operational Summary
Most have many photos, but they remain hidden with limited ways for them to be enjoyed.

This application allows the author to integrate with the storage of those photos and write entries in a digital journal about those photos and explore both in an immersive flexible or curated manner.

### Elements
The primary elements of the app are Entries and ALbums categorized by heirarchical Tags.
    - An entry is a primarily textual, but also visual unit that describes a story of 2 types:
        -Story - Historial narrative.
        - Reflection - Personal insight
    - An album is a primarily visual, but also textual unit. that depicts a story.
    - Entries can be linked to albums and albums can be linked to entries.
    - Both Entries and Albums are categorized into 5 dimesions:
        - who, what, when, where, and reflection. 
        - User selects tag and the Entry or Album inherits the defined ancestor tags
    - Albums are collections of photos 
        - linked to an album of photos
        - collected individually.
    - Album Title and Caption
    - Photos with entries have link
    - Photos with captions
        - Overlaid, Separate, Random
    - Image management key to speed and minimal cost

### Navigation
A central feature of the app is to fluidly navigate through the albums and entries as interest dictates in a virtual 'swim' through the stories and images of one's life. 

### User Interface
Because of the prominence of cellphones for consumption of digital media, the UI is mobile-first focused, but also tablet.
    
- Home Page - Cover page with logo, welcome, navigation.
    - Currently click through with Enter button
    - Eventually, login with user credentials
    - Upper and Lower background image
    - Title of "My Stories" or "My Journal"
    - My name
    - Intro phrase

- Layouts
  - 2 primary layouts
    
    1. Consumption Layout - This layout frames the content consumption layer
    - Universal Header
        - Logo - Click on logo for home.
        - Home
        - New Entry
        - New Album
        - About
        - Admin (Author only)
    - SlideOutLeft Sidebar
        - Three tabs
           - Tags
                - By dimension and heirarchy
                - Multi-select filtering
            - Entries
                - Order by choice
            - Albums
                - Order by choice
    - Content Area
        - Title
        - CardGrid
            - Photo, Title, Excerpt?, Date, Base Tags
            Cards dynamic by Tag, Entry, Album
            - Multiple styles.
            - Animated transitions using Framer Motion
        - Navigation
            - The first unfiltered version of the presentation is 5 cards labeled by those dimensions.
            - Clicking on who opens up a set of cards that make up the next heirarchical level of tags, such as me, parents, grandparents, etc. these cards can be clicked until they drill into cards that contain entries or albums. The entries and or albums can be explored by clicking on them and then they in turn contain related items that can then be clicked and literally swimm through the content. However, on the click of who, the what, when, where and reflection cards remain visible, and they can be drilled into similarly and endlessly.
            - And one can move into and out of each navigatiion method fluidly--randoly or structuredly. 
        - Views
            - Entry 
                - Rich text editor with TipTap
                - 'Blog' style
                - Album link
                - Related entries and albums
            - Album 
                - Dynamic grid layout based on photos, 
                - Photo Captioning
                - Bulk tagging, captioning
                - Entry link
                - Related albums and entries
            - Content Creation
                - Entry - Title, Text, Rich Text Editor with photo embed and tagging 
                - Album- Title, Caption, Photo selector.,
    2. Administration Layout - This layout frames the adminstrative backend for tags, entries and albums.
        - Settings
        - Entry Management
            - Bulk editing
            - Inline editing
            - lick to edit
            - Draft/Published
            - Story/Reflection
        - Album Management
            - Bulk editing
            - Inline editing
        - Tag Management
            - Drag & Drop Heirarchy
            - Inline editing
            - Bulk editing
            

### Tag System
- Multi-dimensional tagging system
- Dimensions:
  - Who: People and relationships
  - What: Activities and events
  - When: Time periods and life stages
  - Where: Locations and places
  - Reflection: Insight
- User selects tag and inheritance is populated
- Add tags on the fly, but must be assigned to heirarchy.
- Update tags doesn't affect assignment, but must make heirarchical sense.
- Delete tags - offer reassignment or removal creating 'orphans'.
- If parent deleted does grandparent absorb or delete rest of tree?

### User
- Authentication and authorization
    - Firebase Authentication integration
    - Role-based access control (Author/Family)
    - Enter button as temporary access method
- Properties:
  - Authentication status
  - Role (Author/Family)
  - Preferences
  - View history
  - Life stage settings
  - Entry type preferences
  - Tag preferences
  - Firebase user profile integration


Navigation - a core feature of the project.
The vision is a visually and textually immerisive experience of vaigating or swimming through to content as interest dictate.
There are 3 macro navigation systems, 2 for content and 1 for administration.
Visual - Card-based
    In this system, the interface is a grid system of multi-size cards, weach with an image and text.
    The system integrates entries, albums and tags.
    At open, the grid displays 5 tag-based cards for
        - Who
        - What
        - When
        - Where
        - Reflection
    At least one card of each of these tag dimensions is present at all times.
        For example, It starts with 5 cards.
            - When Who is clicked, the children of this level are displayed in boxes.
            - The other highest-level boxes remain visible also.
            - the Tag dimensions are color-coded for organization and interest
            - When a child of Who is clicked, its children deploy as boxes and so until until base-level entries and albums deploy.
            - The same occurs with the other dimensions.
            ? Perhaps the order is random or sorted? Choice?
Textual - Tree-based
    In this system, entries, albums and tags are resident in a leftsidebar slideout with 3 tabs.
        - Each of these trees filters the grid-based card system.
        - Or provides direct access to a titled story or album.



            






